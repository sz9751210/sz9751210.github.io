<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | è‰¾å€«çš„ç¨‹å¼ä¹‹æ—…</title>
<meta name=keywords content><meta name=description content="Posts - è‰¾å€«çš„ç¨‹å¼ä¹‹æ—…"><meta name=author content="Alan"><link rel=canonical href=https://sz9751210.github.io/posts/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://sz9751210.github.io/assets/profile/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://sz9751210.github.io/assets/profile/avatar.png><link rel=icon type=image/png sizes=32x32 href=https://sz9751210.github.io/assets/profile/avatar.png><link rel=apple-touch-icon href=https://sz9751210.github.io/assets/profile/avatar.png><link rel=mask-icon href=https://sz9751210.github.io/assets/profile/avatar.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://sz9751210.github.io/posts/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4RLTP9J7DY"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4RLTP9J7DY",{anonymize_ip:!1})}</script><meta property="og:title" content="Posts"><meta property="og:description" content="ExampleSite description"><meta property="og:type" content="website"><meta property="og:url" content="https://sz9751210.github.io/posts/"><meta property="og:image" content="https://sz9751210.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sz9751210.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Posts"><meta name=twitter:description content="ExampleSite description"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sz9751210.github.io/posts/"}]}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8214206744217848" crossorigin=anonymous></script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sz9751210.github.io/ accesskey=h title="Alan's BLOG (Alt + H)"><img src=https://sz9751210.github.io/assets/profile/avatar.png alt aria-label=logo height=35>Alan's BLOG</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sz9751210.github.io/archives/ title=archives><span>archives</span></a></li><li><a href=https://sz9751210.github.io/posts/ title=posts><span class=active>posts</span></a></li><li><a href=https://sz9751210.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://sz9751210.github.io/about/ title=about><span>about</span></a></li><li><a href=https://sz9751210.github.io/quote/ title=quote><span>quote</span></a></li><li><a href=https://sz9751210.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://sz9751210.github.io/>Home</a></div><h1>Posts
<a href=index.xml title=RSS aria-label=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><div class=post-info><header class=entry-header><h2>Reflectï¼šGo èªè¨€çš„é¡å­</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ åœ¨ Go èªè¨€ä¸­ï¼Œreflect packageæ˜¯ç”¨ä¾†æª¢æŸ¥å’Œæ“ä½œè®Šæ•¸çš„typeã€valueå’Œstructã€‚å¸¸è¦‹ç”¨æ³•æœ‰æª¢å¯Ÿ typeã€èª¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¿®æ”¹è®Šæ•¸çš„valueã€‚ä»Šå¤©ç°¡å–®ä»‹ç´¹ reflect packageçš„ä¸»è¦åŠŸèƒ½ã€ä½¿ç”¨æ–¹æ³•å’Œå¸¸è¦‹ç”¨æ³•ã€‚
ä¸»è¦åŠŸèƒ½ reflect package ä¸»è¦ç”¨ä¾†åœ¨é‹è¡Œæ™‚æª¢æŸ¥å’Œæ“ä½œè®Šæ•¸çš„typeè¨Šæ¯ã€‚é€™å°æ–¼éœ€è¦åœ¨ä¸ç¢ºå®štypeçš„æƒ…æ³ä¸‹è™•ç†è³‡æ–™çš„æƒ…æ³éå¸¸æœ‰ç”¨ã€‚è¦ä½¿ç”¨reflect packageï¼Œé¦–å…ˆéœ€è¦importå®ƒï¼š
import "reflect" reflect packageçš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
Type reflect reflect å¯ä»¥è®“ä½ å–å¾—è®Šæ•¸çš„typeè¨Šæ¯ï¼Œæ–¹ä¾¿æˆ‘å€‘åœ¨é‹è¡Œæ™‚é€²è¡Œtypeæ¯”è¼ƒï¼Œæª¢æŸ¥è®Šæ•¸çš„typeã€‚ä¸‹é¢æ˜¯ä¸€äº›åŸºæœ¬çš„type reflectæ“ä½œï¼š
reflect.TypeOfï¼šå–å¾—è®Šæ•¸çš„typeã€‚ reflect.ValueOfï¼šå–å¾—è®Šæ•¸çš„valueã€‚ reflect.Zeroï¼šå»ºç«‹ä¸€å€‹zero valueã€‚ package main import ( "fmt" "reflect" ) func main() { var num int typ := reflect.TypeOf(num) val := reflect.ValueOf(num) zeroVal := reflect.Zero(typ) fmt.Printf("Type: %v\n", typ) // Type: int fmt.Printf("Value: %v\n", val) // Value: 0 fmt.Printf("Zero Value: %v\n", zeroVal) // Zero Value: 0 } Struct reflect reflect å¯ä»¥è®“ä½ å–å¾—structæ¬„ä½çš„è¨Šæ¯ï¼Œè¨ªå•structæ¬„ä½çš„valueï¼Œä»¥åŠä¿®æ”¹structæ¬„ä½çš„valueã€‚...</p></div><footer class=entry-footer><span title="2023-09-15 10:00:00 +0800 CST">2023-09-15</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;602 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-reflect/cover.png alt></figure><a class=entry-link aria-label="post link to Reflectï¼šGo èªè¨€çš„é¡å­" href=https://sz9751210.github.io/posts/go-reflect/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>Timeï¼šGoèªè¨€çš„æ™‚é–“è™•ç†åˆ©å™¨</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ è¦è™•ç†æ—¥æœŸå’Œæ™‚é–“ï¼Œå°±å¿…é ˆçŸ¥é“é€™å€‹Package -> timeï¼ŒGoæä¾›äº†å…§å»ºçš„timePackageã€‚ ä»Šå¤©ä¸»è¦ä»‹ç´¹timeçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ™‚é–“æ“ä½œã€æ ¼å¼åŒ–ç­‰ç­‰ï¼Œä»¥åŠå¸¸è¦‹ç”¨æ³•ã€‚
ä¸»è¦åŠŸèƒ½ timePackageçš„ä¸»è¦åŠŸèƒ½æ˜¯è™•ç†æ™‚é–“å’Œæ—¥æœŸçš„æ“ä½œï¼ŒåŒ…æ‹¬æ™‚é–“çš„è¡¨ç¤ºã€å‰µå»ºã€æ ¼å¼åŒ–å’Œè¨ˆç®—ã€‚åœ¨Goä¸­ï¼Œæ™‚é–“é€šå¸¸ä»¥time.Time typeè¡¨ç¤ºï¼Œé€™å€‹typeåŒ…å«äº†æ—¥æœŸå’Œæ™‚é–“çš„è³‡è¨Šã€‚
å°å…¥Package import "time" å‰µå»ºæ™‚é–“ ä½¿ç”¨time.Now()å‡½æ•¸ä¾†ç²å–ç•¶å‰çš„æ™‚é–“ã€‚
package main import ( "fmt" "time" ) func main() { currentTime := time.Now() fmt.Println("Current Time:", currentTime) } ä½ é‚„å¯ä»¥ä½¿ç”¨time.Date()å‡½æ•¸ä¾†å‰µå»ºä¸€å€‹ç‰¹å®šæ—¥æœŸå’Œæ™‚é–“çš„time.Time ç‰©ä»¶ã€‚
package main import ( "fmt" "time" ) func main() { specificTime := time.Date(2023, time.September, 15, 12, 0, 0, 0, time.UTC) fmt.Println("Specific Time:", specificTime) } æ™‚é–“æ ¼å¼åŒ– timePackageæœ‰æä¾›è¨±å¤šæ–¹æ³•ä¾†æ ¼å¼åŒ–æ™‚é–“ç‚ºå­—ä¸²ã€‚å¯ä»¥ä½¿ç”¨Formatæ–¹æ³•å’ŒæŒ‡å®šçš„æ™‚é–“æ ¼å¼ä¾†å¯¦ç¾ã€‚
package main import ( "fmt" "time" ) func main() { currentTime := time....</p></div><footer class=entry-footer><span title="2023-09-15 10:00:00 +0800 CST">2023-09-15</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;379 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-time/cover.png alt></figure><a class=entry-link aria-label="post link to Timeï¼šGoèªè¨€çš„æ™‚é–“è™•ç†åˆ©å™¨" href=https://sz9751210.github.io/posts/go-time/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>Fmtï¼šè³‡æ–™è™•ç†çš„å¥½å¹«æ‰‹</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ è¦å°å‡ºHello Worldï¼Œå°±æœƒç¢°åˆ°é€™å€‹Package -> fmtï¼Œä»Šå¤©ä¾†ç°¡å–®æ•´ç†ä¸€ä¸‹fmtçš„ä½œç”¨ã€æ ¼å¼åŒ–çš„æ§åˆ¶èˆ‡å¸¸è¦‹ç”¨æ³•ã€‚
ä¸»è¦åŠŸèƒ½ fmt å¥—ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯è™•ç†æ ¼å¼åŒ–çš„è¼¸å‡ºå’Œè¼¸å…¥ï¼ŒåŒ…æ‹¬è³‡æ–™æ ¼å¼è™•ç†ã€å­—ä¸²è§£æå’Œæ•¸å€¼è½‰æ›ç­‰åŠŸèƒ½ã€‚é€šå¸¸ç”¨ä¾†è¨˜éŒ„è¨Šæ¯ã€æª”æ¡ˆè™•ç†ç­‰ç­‰ã€‚fmt å¥—ä»¶ä¸­çš„å‡½æ•¸å¯ä»¥ä¸»è¦åˆ†ç‚ºå…©å¤§é¡ï¼šPrint å’Œ Scanã€‚
å°å…¥Package import "fmt" Print å‡½æ•¸ç³»åˆ— fmt.Printï¼šå°‡è³‡æ–™å°åˆ°çµ‚ç«¯æ©Ÿã€‚ fmt.Printlnï¼šå°‡è³‡æ–™å°åˆ°çµ‚ç«¯æ©Ÿï¼Œä¸¦æ›è¡Œã€‚ fmt.Printfï¼šæ ¹æ“šæ ¼å¼åŒ–åƒæ•¸å°‡è³‡æ–™å°åˆ°çµ‚ç«¯æ©Ÿã€‚ fmt.Sprintfï¼šæ ¼å¼åŒ–æˆå­—ä¸²ï¼Œé€šå¸¸ç”¨åœ¨éœ€è¦ä»¥å­—ä¸²å½¢å¼è™•ç†æ ¼å¼åŒ–æ™‚æœƒç”¨åˆ° fmt.Fprintfï¼šæ ¼å¼åŒ–åˆ°æ–‡ä»¶ï¼Œé€šå¸¸ç”¨ä¾†å¯«æª”æœƒç”¨åˆ° Printèˆ‡Printfç›¸æ¯”ï¼Œå·®åœ¨ä¸èƒ½å°æ ¼å¼åŒ–è¼¸å‡º
Printèˆ‡Printlnç›¸æ¯”ï¼Œå·®åœ¨lnå¤šäº†ä¸€å€‹æ›è¡Œ
package main import ( "fmt" "os" ) func main() { name := "Alan" age := 30 fmt.Print("Name: ", name, " Age: ", age) // æ²’æœ‰æ›è¡Œ fmt.Println("Name:", name, "Age:", age) // æœ‰æ›è¡Œ fmt.Printf("Name: %s Age: %d\n", name, age) // æ ¼å¼åŒ–å°å‡º formatted := fmt.Sprintf("Name: %s, Age: %d", name, age) fmt....</p></div><footer class=entry-footer><span title="2023-09-14 15:44:00 +0800 CST">2023-09-14</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;498 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-fmt/cover.png alt></figure><a class=entry-link aria-label="post link to Fmtï¼šè³‡æ–™è™•ç†çš„å¥½å¹«æ‰‹" href=https://sz9751210.github.io/posts/go-fmt/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>Goèªè¨€ä¸­Goroutineçš„ç­‰å¾…æ–¹å¼</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ æ˜¨å¤©è¬›åˆ°Goroutineçš„æ©‹æ¢akaå‚³è©±ç­’ - Channelï¼Œé‚£è¦æ€éº¼çŸ¥é“å°æ–¹æœ‰æ”¶åˆ°è¨Šæ¯ï¼Œæˆ‘çš„ç´™æ¢æœ‰é€åˆ°å°æ–¹æ‰‹ä¸Šå‘¢? ä»Šå¤©å°±æ˜¯è¦ä¾†ä»‹ç´¹å¹¾ç¨®Goroutineçš„ç¢ºå®šå®Œæˆå·¥ä½œçš„å¹¾ç¨®æ–¹å¼ã€‚
Goroutine çš„ç­‰å¾…æ–¹å¼ åœ¨Goèªè¨€ä¸­ï¼Œç­‰å¾…Goroutineå®Œæˆçš„æ–¹å¼æœ‰å¤šç¨®ã€‚
sync.WaitGroup sync.WaitGroupæ˜¯Goèªè¨€ä¸­å¸¸è¦‹çš„ä¸€ç¨®ç­‰å¾…æ–¹å¼ï¼Œå®ƒå…è¨±æˆ‘å€‘ç­‰å¾…ä¸€çµ„Goroutineå®Œæˆã€‚
package main import ( "fmt" "sync" ) func worker(id int, wg *sync.WaitGroup) { defer wg.Done() // è¡¨ç¤ºGoroutineå®Œæˆå·¥ä½œï¼Œæ¸›å°‘WaitGroupè¨ˆæ•¸ fmt.Printf("Worker %d æ­£åœ¨å·¥ä½œ\n", id) } func main() { var wg sync.WaitGroup for i := 1; i &lt;= 3; i++ { wg.Add(1) // å¢åŠ WaitGroupæ•¸é‡ go worker(i, &amp;wg) // å•Ÿå‹•Goroutineï¼Œä¸¦å°‡WaitGroupçš„æŒ‡é‡å‚³éçµ¦å®ƒ } wg.Wait() // å°‡ä¸»ç¨‹å¼é˜»å¡ï¼Œç›´åˆ°æ‰€æœ‰Goroutineså®Œæˆå·¥ä½œã€‚ fmt.Println("æ‰€æœ‰å·¥ä½œå®Œæˆ") } åœ¨ä¸Šé¢çš„ç¯„ä¾‹ä¸­ï¼Œæˆ‘å€‘å…ˆå‰µå»ºäº†ä¸€å€‹sync.WaitGroupçš„è®Šæ•¸wgï¼Œä¸¦ä½¿ç”¨forå¾ªç’°å»åŸ·è¡Œæˆ‘å€‘çš„goroutineï¼Œæ¯æ¬¡åŸ·è¡Œå‰éƒ½å…ˆå°‡ç­‰å¾…goroutineçš„æ•¸é‡+1ï¼Œç¸½å…±ç­‰å¾…ä¸‰å€‹Goroutineå®Œæˆå·¥ä½œã€‚ æ¥è‘—ä½¿ç”¨ wg.Wait()å°‡mainå‡½æ•¸å…ˆæš«åœä¸€ä¸‹ï¼Œç­‰æ‰€æœ‰goroutineéƒ½å®Œæˆå·¥ä½œï¼Œwgçš„è¨ˆæ•¸å™¨ç‚º0ï¼Œåœ¨ç¹¼çºŒåŸ·è¡Œç¨‹å¼ã€‚ åœ¨ workerå‡½æ•¸è£¡ï¼Œæœƒæ¥æ”¶ wgçš„pointerï¼Œä¸¦åœ¨é–‹é ­ä½¿ç”¨defer wg.Done()åœ¨ç¨‹å¼åŸ·è¡ŒçµæŸå°±å°‡ç­‰å¾…çš„goroutineæ•¸é‡-1ï¼Œä¾†ç¢ºä¿goroutineæœƒå®Œæˆ
Channel Channelæ˜¯Goèªè¨€ä¸­ç”¨æ–¼é€šä¿¡çš„æ©Ÿåˆ¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ–¼ç­‰å¾…Goroutineå®Œæˆã€‚...</p></div><footer class=entry-footer><span title="2023-09-13 16:23:00 +0800 CST">2023-09-13</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;293 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-waitgroup/cover.png alt></figure><a class=entry-link aria-label="post link to Goèªè¨€ä¸­Goroutineçš„ç­‰å¾…æ–¹å¼" href=https://sz9751210.github.io/posts/go-waitgroup/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>Channelï¼šGoèªè¨€å»ºç«‹ä½µç™¼é€šè¨Šçš„æ©‹æ¨‘</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ æ˜¨å¤©è¬›åˆ°Goroutineæœ‰ç¨å¾®ç°¡å–®ä»‹ç´¹Channelï¼ŒChannelæ˜¯Goèªè¨€ä¸­æ¥µç‚ºé‡è¦çš„ä½µç™¼é€šè¨Šæ©Ÿåˆ¶ï¼Œå®ƒå°±åƒæ˜¯ä¸åŒgoroutinesä¹‹é–“çš„è©±ç­’ï¼Œå…è¨±å®ƒå€‘å®‰å…¨åœ°å‚³éè³‡æ–™å’Œä¿¡æ¯ã€‚é€™å€‹å¼·å¤§çš„å·¥å…·ä½¿å¾—Goèªè¨€åœ¨è™•ç†ä½µç™¼ä»»å‹™æ™‚éå¸¸å„ªé›…å’Œé«˜æ•ˆã€‚é€šéChannelï¼Œå¯ä»¥å”èª¿goroutinesçš„æ“ä½œï¼Œé˜²æ­¢ç«¶çˆ­æ¢ä»¶ï¼Œä¸¦å¯¦ç¾é«˜æ•ˆçš„ä½µç™¼ç¨‹å¼è¨­è¨ˆã€‚
ä»€éº¼æ˜¯Channelï¼Ÿ Channelæ˜¯Goèªè¨€ä¸­ä¸€å€‹å¼·å¤§çš„ä½µç™¼åŸèªè¨€åŠŸèƒ½ï¼Œç”¨æ–¼åœ¨ä¸åŒçš„goroutineä¹‹é–“å‚³éè³‡æ–™ã€‚å®ƒå€‘æä¾›äº†ä¸€ç¨®é€šè¨Šçš„æ©Ÿåˆ¶ï¼Œå¯ä»¥è®“goroutinesä¹‹é–“å®‰å…¨åœ°äº¤æ›ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦é¡å¤–çš„äº’æ–¥é–æˆ–ä¿¡è™Ÿé‡ã€‚
å¯ä»¥æŠŠchannelæ¯”å–»æˆå‚³ç´™æ¢ï¼Œå‚³ç´™æ¢å¯ä»¥æ˜¯å–®å‘ï¼Œä¹Ÿå¯ä»¥æ˜¯é›™å‘ï¼Œå–®å‘å¯ä»¥æƒ³åƒé¡ä¼¼ä»¥å‰å‚³ç´™æ¢çš„ä¸­é–“äººï¼Œä»–åªæ¥æ”¶å’Œå‚³éï¼Œç´™æ¢ä¹Ÿæœ‰å¤§å°çš„é™åˆ¶ï¼Œå¯«æ»¿äº†å°±ä¸èƒ½å†ç¹¼çºŒå¯«ï¼Œä¸¦ä¸”éœ€è¦ç­‰å¾…å°æ–¹å°‡ç´™æ¢é€²è¡Œå›è¦†å¾Œä½ æ‰èƒ½ç¹¼çºŒã€‚
å»ºç«‹å’Œä½¿ç”¨Channel åœ¨Goä¸­ï¼Œå¯ä»¥ä½¿ç”¨å…§å»ºçš„makeå‡½æ•¸ä¾†å»ºç«‹ä¸€å€‹æ–°çš„Channelã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ makeå‡½æ•¸å»ºç«‹æ•´æ•¸é¡å‹çš„Channel
ch := make(chan int) å»ºç«‹å®Œå¾Œï¼Œå°±å¯ä»¥å°‡è³‡æ–™ç™¼é€åˆ°Channelä¸­ï¼Œç„¶å¾Œåœ¨å…¶ä»–goroutineä¸­æ¥æ”¶å®ƒå€‘ã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ç™¼é€å’Œæ¥æ”¶è³‡æ–™çš„ä¾‹å­ï¼š
func main() { ch := make(chan int) go func() { ch &lt;- 42 // ç™¼é€è³‡æ–™åˆ°Channel }() value := &lt;-ch // å¾Channelæ¥æ”¶è³‡æ–™ fmt.Println(value) // è¼¸å‡ºï¼š42 } é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘å»ºç«‹äº†ä¸€å€‹goroutineï¼Œå®ƒå°‡æ•¸å­—42ç™¼é€åˆ°Channelï¼Œç„¶å¾Œä¸»goroutineï¼Œä¹Ÿå°±æ˜¯mainå‡½æ•¸ï¼Œæ¥æ”¶åˆ°é€™å€‹æ•¸å­—ã€‚
é—œé–‰Channel ç´™æ¢ç”¨å®Œæœƒä¸Ÿæ‰ï¼ŒChannelç”¨å®Œä¹Ÿæ˜¯è¦é—œæ‰ï¼Œæ‚¨å¯èƒ½éœ€è¦é—œé–‰Channelï¼Œä»¥é€šçŸ¥æ¥æ”¶æ–¹ä¸å†æœ‰æ–°çš„è³‡æ–™å¯ç”¨ã€‚è¦é—œé–‰Channelï¼Œå¯ä»¥ä½¿ç”¨closeå‡½æ•¸ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
close(ch) æ¥æ”¶æ–¹å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„èªæ³•ä¾†æª¢æŸ¥Channelæ˜¯å¦å·²é—œé–‰ï¼š
value, ok := &lt;-ch if !ok { // Channelå·²ç¶“é—œé–‰ } é€™å¯ä»¥é˜²æ­¢æ¥æ”¶æ–¹åœ¨Channelå·²é—œé–‰çš„æƒ…æ³ä¸‹ç¹¼çºŒç­‰å¾…ã€‚ ä¸¦ä¸”å·²ç¶“é—œé–‰çš„Channelä¾ç„¶å¯ä»¥é€²è¡Œæ¥æ”¶çš„æ“ä½œï¼Œä½†ä¸èƒ½å†é€²è¡Œç™¼é€ã€‚
package main import ( "fmt" "time" ) func main() { ch := make(chan int) go func() { for i := 0; i &lt; 5; i++ { time....</p></div><footer class=entry-footer><span title="2023-09-12 16:09:00 +0800 CST">2023-09-12</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;460 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-channel/cover.png alt></figure><a class=entry-link aria-label="post link to Channelï¼šGoèªè¨€å»ºç«‹ä½µç™¼é€šè¨Šçš„æ©‹æ¨‘" href=https://sz9751210.github.io/posts/go-channel/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>æ¢ç´¢Goroutineï¼šGoèªè¨€çš„ä½µç™¼é­”æ³•</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œå¦‚æœèƒ½åŒæ™‚åšå¾ˆå¤šäº‹æƒ…ï¼Œæ•ˆç‡è‚¯å®šå¤§å¤§æå‡ï¼Œé‚£éº¼åœ¨Goèªè¨€ä¸­ï¼Œè©²å¦‚ä½•åšåˆ°å‘¢ï¼Œç­”æ¡ˆå°±æ˜¯ä»Šå¤©çš„ä¸»è§’Goroutineäº†ï¼Œåœ¨Goèªè¨€ä¸­ï¼Œè®“ä½µç™¼è®Šå¾—ç°¡å–®çš„å¼·å¤§å·¥å…·ï¼Œä»Šå¤©å°±æ˜¯ä¾†çµ¦ä»–ä¸€å€‹å¿«é€Ÿä»‹ç´¹ã€‚
ä»€éº¼æ˜¯Goroutineï¼Ÿ é¦–å…ˆï¼Œè®“æˆ‘å€‘ä»¥ä¸€å€‹ç°¡å–®çš„æ–¹å¼ä¾†è§£é‡‹ä»€éº¼æ˜¯Goroutineã€‚Goroutineæ˜¯Goèªè¨€çš„ä¸€å€‹ç‰¹åˆ¥çš„åŠŸèƒ½ï¼Œå®ƒå°±åƒæ˜¯å°å‹çš„å·¥ä½œä»»å‹™ï¼Œå¯ä»¥è®“æˆ‘å€‘åŒæ™‚è™•ç†å¾ˆå¤šäº‹æƒ…ï¼Œè€Œä¸éœ€è¦æµªè²»å¤ªå¤šé›»è…¦è³‡æºã€‚å¯ä»¥æŠŠå®ƒæƒ³åƒæˆæ¯”å‚³çµ±æ–¹å¼æ›´è°æ˜çš„æ–¹å¼ä¾†è™•ç†å¤šé …å·¥ä½œï¼Œè€Œä¸æœƒè®“é›»è…¦è®Šå¾—è¶…ç´šå¿™ç¢Œã€‚é€™ç¨®åŠŸèƒ½è®“Goèªè¨€åœ¨è™•ç†å¤§é‡åŒæ™‚åŸ·è¡Œçš„å·¥ä½œæ™‚è®Šå¾—éå¸¸å¼·å¤§ã€‚
å¦‚ä½•å‰µå»ºå’Œå•Ÿå‹•Goroutine è¦ä½¿ç”¨Goroutineå¾ˆç°¡å–®ï¼Œåªéœ€è¦å‰µå»ºä¸€å€‹å‡½æ•¸ï¼Œç„¶å¾Œä½¿ç”¨goé—œéµå­—åœ¨è¦ä½¿ç”¨goroutineçš„å‡½æ•¸å‰é¢å°±å®Œæˆäº†ã€‚å¯ä»¥çœ‹ä»¥ä¸‹ç¯„ä¾‹ï¼š
package main import ( "fmt" ) func main() { go sayHello() // ä¸»ç¨‹å¼ä¸æœƒç­‰å¾…Goroutineå®Œæˆ } func sayHello() { fmt.Println("Hello, Goroutine!") } åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨goé—œéµå­—å•Ÿå‹•ä¸€å€‹æ–°çš„Goroutineï¼ŒGoroutineåŸ·è¡Œäº†sayHelloå‡½æ•¸ã€‚ä½†é ˆæ³¨æ„ï¼Œä¸»ç¨‹å¼mainä¸æœƒç­‰å¾…Goroutineå®Œæˆï¼Œæ‰€ä»¥å¯èƒ½ä¸æœƒçœ‹åˆ°æœ‰å°å‡ºä»»ä½•æ±è¥¿ä¾†ã€‚
å¯ä»¥ç¨å¾®è®“mainä¸»ç¨‹å¼ç¡ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°è¼¸å‡ºäº†
package main import ( "fmt" "time" ) func main() { go sayHello() time.Sleep(1) } func sayHello() { fmt.Println("Hello, Goroutine!") } Goroutineçš„åŸ·è¡Œéç¨‹ ä¸‹é¢æä¾›äº†ä¸€å€‹ç°¡å–®çš„å°ç¨‹å¼ï¼Œåœ¨ä¸»ç¨‹å¼è£¡æœ‰å…©å€‹goroutineï¼Œè©¦è‘—åŸ·è¡Œä¸€ä¸‹ç¨‹å¼å¯ä»¥ç™¼ç¾è¼¸å‡ºæ˜¯ä¸€æ®µä¸€æ®µçš„ï¼Œæœƒæ˜¯0è·Ÿ1äº¤éŒ¯å°å‡ºï¼Œä»£è¡¨å…©é‚Šçš„goroutineæœƒæ¶è‘—å°å‡ºï¼Œå‘ˆç¾ç«¶çˆ­ç‹€æ…‹
package main import ( "fmt" "time" ) func main() { go print1() go print2() time.Sleep(time.Second) } func print1() { for i := 0; i &lt; 100; i++ { fmt....</p></div><footer class=entry-footer><span title="2023-09-11 16:18:00 +0800 CST">2023-09-11</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;279 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-goroutine/cover.png alt></figure><a class=entry-link aria-label="post link to æ¢ç´¢Goroutineï¼šGoèªè¨€çš„ä½µç™¼é­”æ³•" href=https://sz9751210.github.io/posts/go-goroutine/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>æ·ºè«‡Goä¸­çš„Pointerå’Œè¨˜æ†¶é«”ç®¡ç†</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ ç•¶æˆ‘å€‘åœ¨å®£å‘Šè®Šæ•¸æ™‚ï¼Œé›»è…¦æœƒç‚ºè©²è®Šæ•¸åœ¨è¨˜æ†¶é«”ä¸­åˆ†é…ä¸€å€‹ä½ç½®ï¼Œç„¶å¾Œå°‡é€™å€‹è®Šæ•¸å€¼å„²å­˜åœ¨é€™å€‹ä½ç½®ä¸Šï¼Œéœ€è¦è®€å–æˆ–ä¿®æ”¹é€™å€‹è®Šæ•¸å€¼æ™‚ï¼Œé›»è…¦æ˜¯é€éè¨˜æ†¶é«”ä½ç½®ä¾†å­˜å–é€™å€‹å€¼ã€‚ ä»Šå¤©ä¾†ç°¡å–®ä»‹ç´¹ä¸€ä¸‹goçš„Pointerï¼Œä»–çš„ç‰¹æ€§ä»¥åŠå¸¸è¦‹ç”¨æ³•ã€‚
ä»€éº¼æ˜¯Pointerï¼Ÿ Pointeræ˜¯ä¸€ç¨®è³‡æ–™é¡å‹ï¼Œç”¨ä¾†å„²å­˜è®Šæ•¸çš„è¨˜æ†¶é«”åœ°å€ã€‚åœ¨Goä¸­ï¼Œæˆ‘å€‘å¯ä»¥é€šéä½¿ç”¨ * ç¬¦è™Ÿä¾†å®£å‘Šå’Œæ“ä½œPointerã€‚é€™å…è¨±æˆ‘å€‘ç›´æ¥è¨ªå•å’Œä¿®æ”¹è®Šæ•¸çš„å…§å®¹ï¼Œè€Œä¸åƒ…åƒ…æ˜¯è®€å–æˆ–è¤‡è£½å®ƒå€‘çš„å€¼ã€‚
Pointerçš„ç‰¹æ€§ã€é™åˆ¶èˆ‡å¸¸è¦‹ç”¨æ³• ç‰¹æ€§ Pointerçš„å€¼å’Œåœ°å€ æ¯å€‹è®Šæ•¸éƒ½æœ‰ä¸€å€‹è¨˜æ†¶é«”åœ°å€ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨Pointerè®Šæ•¸ä¾†å„²å­˜é€™å€‹åœ°å€ã€‚è®“æˆ‘å€‘çœ‹ä¸€å€‹ç¯„ä¾‹ï¼š
package main import "fmt" func main() { x := 42 var p *int // å®£å‘Šä¸€å€‹æ•´æ•¸Pointer p = &amp;x // å°‡pæŒ‡å‘xçš„åœ°å€ fmt.Println("x =", x) fmt.Println("p =", p) } åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘å‰µå»ºäº†ä¸€å€‹æ•´æ•¸è®Šæ•¸ xï¼Œä¸¦å®£å‘Šäº†ä¸€å€‹æ•´æ•¸Pointer pï¼Œç„¶å¾Œå°‡ p è¨­ç‚º x çš„åœ°å€ã€‚ç¾åœ¨ï¼Œp è£¡é¢å­˜æ”¾çš„å°±æ˜¯ x çš„åœ°å€ã€‚
Pointerçš„åˆå§‹åŒ– Goä¸­çš„Pointerå¯ä»¥é€šé new å‡½æ•¸ä¾†åˆå§‹åŒ–ï¼Œé€™å°‡ç‚ºæŒ‡å®šçš„é¡å‹åˆ†é…è¨˜æ†¶é«”ä¸¦è¿”å›å…¶åœ°å€ã€‚ç¯„ä¾‹ï¼š
package main import "fmt" func main() { var p *int p = new(int) // åˆå§‹åŒ–ä¸€å€‹æ•´æ•¸Pointer *p = 123 // å°‡Pointeræ‰€æŒ‡å‘çš„è¨˜æ†¶é«”è¨­ç½®ç‚º123 fmt....</p></div><footer class=entry-footer><span title="2023-09-08 15:50:00 +0800 CST">2023-09-08</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;403 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-pointer/cover.png alt></figure><a class=entry-link aria-label="post link to æ·ºè«‡Goä¸­çš„Pointerå’Œè¨˜æ†¶é«”ç®¡ç†" href=https://sz9751210.github.io/posts/go-pointer/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>éŒ¯èª¤è™•ç†çš„ç²¾é«“ï¼šå¿«é€Ÿäº†è§£Goèªè¨€çš„ errorã€panicå’Œrecover</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ åœ¨è»Ÿé«”é–‹ç™¼ä¸­ï¼ŒéŒ¯èª¤ç„¡æ‰€ä¸åœ¨ã€‚ç„¡è«–æ˜¯ç¶²è·¯è«‹æ±‚å¤±æ•—ã€æª”æ¡ˆä¸å­˜åœ¨ï¼Œé‚„æ˜¯æ•¸å­¸è¨ˆç®—éŒ¯èª¤ï¼Œè™•ç†éŒ¯èª¤æ˜¯ä»»ä½•é–‹ç™¼è€…çš„æ—¥å¸¸å·¥ä½œï¼Œç³»çµ±çš„ç©©å®šåº¦åŸºæœ¬å–æ±ºæ–¼å°æ–¼éŒ¯èª¤è™•ç†æ˜¯å¦å…¨é¢ï¼Œå¥½çš„éŒ¯èª¤è™•ç†ä¹Ÿå¯ä»¥ç”¢ç”Ÿé©ç•¶çš„éŒ¯èª¤è¨Šæ¯ï¼Œè®“ Debug æ›´åŠ å®¹æ˜“ã€‚åœ¨Goèªè¨€ä¸­ï¼Œæœ‰ä¸€äº›ç¨ç‰¹çš„åŠŸèƒ½åœ¨è™•ç†éŒ¯èª¤å’Œè³‡æºç®¡ç†æ–¹é¢éå¸¸æœ‰ç”¨ã€‚ï¼Œå…¶ä¸­åŒ…æ‹¬errorã€panicå’Œrecoverã€‚ä»Šå¤©å°±ä¾†ä»‹ç´¹é€™ä¸‰å€‹é—œéµå­—èˆ‡éŒ¯èª¤è™•ç†çš„ç°¡å–®ç”¨æ³•ã€‚
Error ä»€éº¼æ˜¯Error? åœ¨Goä¸­ï¼ŒErroræ˜¯ä¸€å€‹æ“æœ‰error interfaceçš„é¡å‹ï¼Œå¯ä»¥çœ‹åˆ°ä»–åªæœ‰ä¸€å€‹æ–¹æ³•ï¼Œè©²æ–¹æ³•ä¸»è¦ç”¨ä¾†æè¿°ä¸€å€‹éŒ¯èª¤çš„å­—ä¸²ã€‚
type error interface { Error() string } å¦‚ä½•ç”¢ç”ŸéŒ¯èª¤è¨Šæ¯ errors.New() ä½¿ç”¨æ–¹å¼å¾ˆç°¡å–®ï¼Œåœ¨è£¡é¢æ”¾å…¥è¦é¡¯ç¤ºçš„éŒ¯èª¤è¨Šæ¯ package main import ( "errors" "fmt" ) func main() { err := errors.New("This is a custom error message") fmt.Println(err.Error()) // outputï¼šThis is a custom error message } fmt.Errorf() ä¸»è¦ç”¨åœ¨æ ¼å¼åŒ–éŒ¯èª¤è¨Šæ¯çš„æƒ…æ³ä¸‹ package main import ( "fmt" ) func main() { name := "John" err := fmt.Errorf("Hello, %s! This is a custom error message", name) fmt....</p></div><footer class=entry-footer><span title="2023-09-07 11:30:00 +0800 CST">2023-09-07</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;559 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-error/cover.png alt></figure><a class=entry-link aria-label="post link to éŒ¯èª¤è™•ç†çš„ç²¾é«“ï¼šå¿«é€Ÿäº†è§£Goèªè¨€çš„ errorã€panicå’Œrecover" href=https://sz9751210.github.io/posts/go-error/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>Goèªè¨€çš„deferï¼šç¢ºä¿å¾Œç½®æ“ä½œçš„åŸ·è¡Œ</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ ç•¶æˆ‘å€‘åœ¨å¯«ç¨‹å¼æ™‚ï¼Œæœ‰æ™‚å€™æœƒéœ€è¦åœ¨ç¨‹å¼çµæŸæ™‚é—œé–‰æŸäº›è³‡æºï¼Œè€Œdeferé€™å€‹é—œéµå­—ï¼Œå¯ä»¥è®“ä½ è¼•é¬†çš„å¯¦ç¾ï¼Œä¸‹é¢ä¾†ç°¡å–®ä»‹ç´¹ä¸€ä¸‹deferä»¥åŠå¸¸ç”¨çš„ç¯„ä¾‹ã€‚ï¼Œå®ƒç‚ºç¨‹å¼è¨­è¨ˆå¸«æä¾›äº†ä¸€ç¨®ç°¡å–®è€Œå¼·å¤§çš„å·¥å…·ï¼Œç”¨æ–¼ç®¡ç†è³‡æºå’Œç¢ºä¿ç¨‹å¼çš„æ­£ç¢ºåŸ·è¡Œã€‚åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å€‘å°‡æ·±å…¥æ¢è¨Goèªè¨€ä¸­çš„deferï¼Œä¸¦æä¾›ä¸€äº›å¯¦éš›çš„ç¨‹å¼ç¢¼ç¯„ä¾‹ï¼Œä»¥å¹«åŠ©ä½ ç†è§£å®ƒçš„å·¥ä½œåŸç†ä»¥åŠå¦‚ä½•é‹ç”¨å®ƒä¾†æé«˜ç¨‹å¼çš„å¯è®€æ€§å’Œå¯ç¶­è­·æ€§ã€‚
ä»€éº¼æ˜¯deferï¼Ÿ deferæ˜¯ä¸€å€‹é—œéµå­—ï¼Œç”¨ä¾†å»¶é²å‡½æ•¸çš„åŸ·è¡Œï¼Œç›´åˆ°åŒ…å«å®ƒçš„å‡½æ•¸åŸ·è¡Œå®Œç•¢ã€‚é€™ä»£è¡¨ä½ å¯ä»¥åœ¨å‡½æ•¸ä¸­çš„ä»»ä½•ä½ç½®ä½¿ç”¨deferä¾†å®‰æ’æŸå€‹æ“ä½œï¼Œä¸¦ç¢ºä¿å®ƒå°‡åœ¨å‡½æ•¸è¿”å›ä¹‹å‰åŸ·è¡Œã€‚deferé€šå¸¸ç”¨æ–¼åŸ·è¡Œä¸€äº›æ¸…ç†æˆ–è³‡æºå›æ”¶çš„æ“ä½œã€‚
package main import "fmt" func main() { defer fmt.Println("World") fmt.Print("Hello, ") } ä½¿ç”¨æ–¹å¼ä¹Ÿå¾ˆç°¡å–®ï¼Œåœ¨è¦åŸ·è¡Œçš„å‡½æ•¸å‰é¢åŠ ä¸Šdeferå°±å®Œæˆäº†ï¼Œæ‰€ä»¥ä¸Šé¢çš„ç¯„ä¾‹æœƒå°å‡º Hello World
Deferçš„ç‰¹æ€§ å»¶é²åŸ·è¡Œï¼šdefer èªå¥å…è¨±ä½ å®‰æ’ä¸€æ®µç¨‹å¼ç¢¼ï¼Œä½¿å®ƒåœ¨åŒ…å«å®ƒçš„å‡½æ•¸è¿”å›ä¹‹å‰åŸ·è¡Œï¼Œç„¡è«–å‡½æ•¸æ˜¯å¦æ­£å¸¸è¿”å›æˆ–å‡ºç¾éŒ¯èª¤ã€‚
å †ç–Šç‰¹æ€§ï¼šå¤šå€‹ defer èªå¥æŒ‰ç…§å¾Œé€²å…ˆå‡ºï¼ˆLIFOï¼‰çš„é †åºåŸ·è¡Œï¼Œé€™æ„å‘³è‘—æœ€å¾Œä¸€å€‹è¢«å»¶é²çš„èªå¥æœƒæœ€å…ˆåŸ·è¡Œã€‚
package main import "fmt" func main() { fmt.Println("Start") defer fmt.Println("Deferred 1") defer fmt.Println("Deferred 2") fmt.Println("End") } æ ¹æ“šdeferç‰¹æ€§çš„å¾Œé€²å…ˆå‡ºï¼Œè¼¸å‡ºæœƒæ˜¯ä¸‹é¢é€™å€‹æ¨£å­
Start End Deferred 2 Deferred 1 Deferçš„é™åˆ¶ å»¶é²çš„å‡½æ•¸å¿…é ˆæ˜¯ç„¡åƒæ•¸å‡½æ•¸ï¼šä½ åªèƒ½å»¶é²ç„¡åƒæ•¸çš„å‡½æ•¸èª¿ç”¨ï¼Œå› ç‚º defer ä¸å…è¨±å‚³éåƒæ•¸ã€‚
é †åºæ€§ï¼šdefer èªå¥çš„æ•ˆæœåœ¨å‡½æ•¸å…§æ˜¯æœ‰é™å®šç¯„åœçš„ï¼Œå®ƒåªåœ¨åŒ…å«å®ƒçš„å‡½æ•¸ç¯„åœå…§æœ‰æ•ˆï¼Œç„¡æ³•è·¨å‡½æ•¸ä½¿ç”¨ã€‚
å¸¸è¦‹ç”¨æ³• è³‡æºæ¸…ç† æœ€å¸¸è¦‹çš„ç”¨é€”ä¹‹ä¸€æ˜¯åœ¨å‡½æ•¸è¿”å›å‰é—œé–‰æ–‡ä»¶ã€é‡‹æ”¾é–ã€é—œé–‰è³‡æ–™åº«é€£æ¥ç­‰ï¼Œä»¥ç¢ºä¿è³‡æºè¢«æ­£ç¢ºé‡‹æ”¾ã€‚
func readFile(filename string) (string, error) { file, err := os.Open(filename) if err != nil { return "", err } defer file....</p></div><footer class=entry-footer><span title="2023-09-06 20:30:00 +0800 CST">2023-09-06</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;135 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-defer/cover.png alt></figure><a class=entry-link aria-label="post link to Goèªè¨€çš„deferï¼šç¢ºä¿å¾Œç½®æ“ä½œçš„åŸ·è¡Œ" href=https://sz9751210.github.io/posts/go-defer/></a></article><article class=post-entry><div class=post-info><header class=entry-header><h2>ä¿è­‰å‹åˆ¥å®‰å…¨ï¼šä½¿ç”¨Goçš„Type Assertionsé¿å…å‹åˆ¥éŒ¯èª¤</h2></header><div class=entry-content><p>ğŸ‘¨â€ğŸ’»ç°¡ä»‹ åœ¨Goä¸­ï¼Œå‡å¦‚æˆ‘è¦åˆ¤æ–·ä¸€å€‹è³‡æ–™é¡å‹æ˜¯ç”šéº¼ï¼Œè©²æ€éº¼åšå‘¢? Golangæœ‰ä¸€å€‹åŠŸèƒ½å«åšType Assertionsï¼ˆé¡å‹æ–·è¨€ï¼‰ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯èƒ½å¤ åœ¨é‹è¡Œæ™‚æª¢æŸ¥æˆ‘çš„è³‡æ–™é¡å‹ï¼Œè®“æˆ‘åœ¨å‚³éé¡å‹æ™‚èƒ½ç¢ºä¿è³‡æ–™é¡å‹æ˜¯æ­£ç¢ºçš„ã€‚
Type Assertions çš„åŸºæœ¬æ¦‚å¿µ åœ¨Goä¸­ï¼ŒType Assertionsçš„ä¸»è¦ç›®çš„æ˜¯åœ¨é‹è¡Œæ™‚å°‡ interface å‹åˆ¥çš„å€¼è½‰æ›ç‚ºç‰¹å®šçš„å¯¦éš›å‹åˆ¥ã€‚interface æ˜¯ä¸€ç¨®ç‰¹æ®Šçš„é¡å‹ï¼Œå®ƒå¯ä»¥ä¿å­˜ä»»ä½•å€¼çš„å¯¦ä¾‹ï¼Œä½†åœ¨é‹è¡Œæ™‚ï¼Œæˆ‘å€‘å¯èƒ½éœ€è¦ç¢ºå®šè©²å€¼çš„å¯¦éš›é¡å‹ä»¥åŸ·è¡Œç›¸æ‡‰çš„æ“ä½œï¼Œä»¥ç¢ºä¿æˆ‘å€‘èƒ½å¤ å®‰å…¨åœ°æ“ä½œè³‡æ–™ï¼Œé€™å°±æ˜¯Type Assertionsçš„ä½œç”¨ã€‚
Type Assertionsçš„åŸºæœ¬èªæ³•å¦‚ä¸‹ï¼š
value, ok := someInterface.(T) é€™å€‹è¡¨é”å¼æ„æ€ç‚ºå°‡someInterfaceè½‰æ›ç‚ºé¡å‹Tã€‚å¦‚æœæˆåŠŸï¼Œå®ƒå°‡valueè¨­ç½®ç‚ºè½‰æ›å¾Œçš„å€¼ï¼Œä¸¦å°‡okè¨­ç½®ç‚ºtrueã€‚å¦‚æœè½‰æ›å¤±æ•—ï¼Œå‰‡valueå°‡æ˜¯é›¶å€¼ï¼Œè€Œokå°‡æ˜¯falseã€‚
Type Assertionsçš„ç”¨é€” Type Assertions çš„ä¸»è¦ç”¨é€”åŒ…æ‹¬ï¼š
è³‡æ–™å‹åˆ¥çš„è½‰æ› ç•¶æˆ‘å€‘è™•ç†interfaceå‹åˆ¥çš„è³‡æ–™æ™‚ï¼Œå¯èƒ½éœ€è¦å°‡å…¶è½‰æ›ç‚ºå…·é«”çš„å‹åˆ¥ï¼Œä»¥ä¾¿é€²è¡Œç‰¹å®šæ“ä½œã€‚
func process(someInterface interface{}) { if str, ok := someInterface.(string); ok { // å°‡interfacceè½‰æ›ç‚ºstringé¡å‹ä¸¦é€²è¡Œæ“ä½œ fmt.Printf("Length of string: %d\n", len(str)) } else { fmt.Println("Not a string") } } ç¢ºä¿å‹åˆ¥çš„æ­£ç¢ºæ€§ ä½¿ç”¨ Type Assertionsï¼Œæˆ‘å€‘å¯ä»¥åœ¨åŸ·è¡Œç‰¹å®šæ“ä½œä¹‹å‰ï¼Œç¢ºä¿è³‡æ–™çš„å‹åˆ¥æ˜¯æˆ‘å€‘æœŸæœ›çš„ã€‚é€™æœ‰åŠ©æ–¼é˜²æ­¢å› å‹åˆ¥éŒ¯èª¤è€Œå¼•ç™¼çš„åŸ·è¡Œæ™‚éŒ¯èª¤ã€‚
if val, ok := someInterface.(int); ok { // someInterface æ˜¯ä¸€å€‹inté¡å‹ fmt.Printf("Value is an int: %d\n", val) } else { // someInterface ä¸æ˜¯ä¸€å€‹inté¡å‹ fmt....</p></div><footer class=entry-footer><span title="2023-09-05 15:31:00 +0800 CST">2023-09-05</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;397 words&nbsp;Â·&nbsp;Alan</footer></div><figure class=entry-cover><img loading=lazy src=https://sz9751210.github.io/assets/go-type-assertion/cover.png alt></figure><a class=entry-link aria-label="post link to ä¿è­‰å‹åˆ¥å®‰å…¨ï¼šä½¿ç”¨Goçš„Type Assertionsé¿å…å‹åˆ¥éŒ¯èª¤" href=https://sz9751210.github.io/posts/go-type-assertion/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://sz9751210.github.io/posts/page/2/>Â«&nbsp;Prev&nbsp;
</a><a class=next href=https://sz9751210.github.io/posts/page/4/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://sz9751210.github.io/>è‰¾å€«çš„ç¨‹å¼ä¹‹æ—…</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let detail=document.getElementsByClassName("details");details=[].slice.call(detail);for(let e=0;e<details.length;e++){let t=details[e];const n=t.getElementsByClassName("details-summary")[0];n&&n.addEventListener("click",()=>{t.classList.toggle("open")},!1)}</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>